<head>
    <link rel="stylesheet" href="./src/css/user-auth.css">
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script defer src="./src/js/init-firebase.js"></script>
</head>
<body>
    <div class="wrapper">
        <div class="content">
            <div class="content-header">
                Welcome!
            </div>
            <div class="content-data">  
                <textarea id="username-input" placeholder="Username"></textarea>
                <textarea id="password-input" placeholder="Password"></textarea>
                <div id="button">
                    Continue
                </div>
            </div>
        </div>
    </div>
</body>
<script>    
    const button = document.getElementById('button')


    button.onclick = e => {
        const usernameInput = document.getElementById('username-input')
        const passwordInput = document.getElementById('password-input')

        usernameInput.value = String(usernameInput.value)
        passwordInput.value = String(passwordInput.value)

        usernameInput.value = usernameInput.value.trim()
        passwordInput.value = passwordInput.value.trim()
            
        if(usernameInput.value == "" || passwordInput.value == "") return alert("Please fill in all fields.")
        if(usernameInput.value.split("").includes(" ")) return alert("Username cannot contain spaces.")
    
        if(usernameInput.value == 'DUMMY') return alert("No.")

        let userData = db.collection('users').doc(`/${usernameInput.value}`);
        userData.get().then(doc => {
            let data = doc.data()
            if(data == undefined){
                userData.set({
                    password: passwordInput.value,
                    admin: false,
                })
            } else {
                alert("Username already exists.")
            }
        })
    }  
</script>